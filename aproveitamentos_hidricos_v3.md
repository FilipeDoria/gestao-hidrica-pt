# Guia Completo: Base de Dados de Aproveitamentos H√≠dricos de Portugal

## üìä Fontes Principais de Dados

### 1. **Open Infrastructure Map (OpenStreetMap)**
- **URL**: https://openinframap.org/stats/area/Portugal/plants?source=hydro
- **Dados Dispon√≠veis**: 
  - 200 centrais hidroel√©tricas mapeadas
  - Pot√™ncia instalada: 8.513 MW
  - Localiza√ß√£o geogr√°fica em mapa interativo
  - Tipo de aproveitamento (armazenamento vs fio de √°gua)
  - Operador/Propriet√°rio
  - Pot√™ncia individual de cada central

**Vantagens**:
- ‚úÖ Dados geoespaciais (mapa interativo)
- ‚úÖ Acesso aberto e gratuito
- ‚úÖ Classifica√ß√£o por tipo de aproveitamento
- ‚úÖ Dados estruturados em tabela export√°vel

**Limita√ß√µes**:
- ‚ùå Podem ter lacunas (nem todas as centrais)
- ‚ùå Dados crowdsourced (variam em precis√£o)

---

### 2. **Ag√™ncia Portuguesa do Ambiente (APA) - Barragens de Portugal**
- **URL**: https://apambiente.pt/prevencao-e-gestao-de-riscos/barragens-de-portugal
- **Dados Dispon√≠veis**:
  - 260 grandes barragens (altura > 15m ou volume > 1 hm¬≥)
  - Lista completa de albufeiras classificadas
  - Informa√ß√µes de utiliza√ß√£o (produ√ß√£o energia, rega, abastecimento)
  - Classifica√ß√£o de estado e prote√ß√£o

**Informa√ß√£o Detalhada**:
- Dispon√≠vel: https://apambiente.pt/agua/lista-de-albufeiras-lagos-e-lagoas-classificados

**Dados por Bacia Hidrogr√°fica**:
- Lima
- C√°vado
- Douro
- Mondego
- Vouga
- Ribeiras do Oeste
- Mira
- Guadiana

---

### 3. **Boletim Semanal de Albufeiras (APA)**
- **URL**: https://apambiente.pt/agua/sistema-nacional-de-informacao-de-recursos-hidricos-snirh
- **Dados Dispon√≠veis**:
  - Volume armazenado em tempo real
  - Percentagem de enchimento por albufeira
  - Evolu√ß√£o semanal/mensal
  - Dados hist√≥ricos (desde 1990/91)
  - Situa√ß√£o cr√≠tica de albufeiras

---

### 4. **Comiss√£o Nacional Portuguesa de Grandes Barragens (CNPGB)**
- **Mapa Oficial**: https://cnpgb.apambiente.pt/mapabarragens
- **Lista Completa**: https://cnpgb.apambiente.pt/lista_barragens
- **Dados Dispon√≠veis**:
  - Localiza√ß√£o por distrito e concelho
  - Caracter√≠sticas t√©cnicas
  - Estado de seguran√ßa
  - Regula√ß√£o normativa

---

### 5. **Energias de Portugal (EDP) - Dados Corporativos**
- **Relat√≥rio 2024**: https://www.edp.com/pt/noticia/relatorio-anual
- **Dados Dispon√≠veis**:
  - 46 centrais hidroel√©tricas operacionais
  - Pot√™ncia total: 5.785 MW
  - Produ√ß√£o anual m√©dia: 11.400 GWh
  - Informa√ß√µes por sistema de aproveitamento:
    - Sistema do Douro (17+3 centrais, 1.656 MW)
    - Sistema do Tejo-Mondego (10 centrais, 1.552 MW)
    - Sistema do C√°vado-Lima (37 centrais, 160 MW)
  - Caracter√≠sticas de cada central (tipo, produtibilidade, infraestruturas)

**Documentos T√©cnicos**:
- EMAS Declaration 2024: Dados ambientais e operacionais detalhados
- Relat√≥rio EDP A Hidroeletricidade em Portugal

---

### 6. **SNIRH - Sistema Nacional de Informa√ß√£o de Recursos H√≠dricos**
- **URL**: https://snirh.apambiente.pt/
- **Dados Dispon√≠veis**:
  - Monitoriza√ß√£o em tempo real
  - Dados hidrol√≥gicos por bacia
  - Qualidade da √°gua
  - Caudais
  - S√©ries hist√≥ricas

---

### 7. **REN Data Hub**
- **URL**: https://datahub.ren.pt/
- **Dados Dispon√≠veis**:
  - Informa√ß√£o sobre energia em Portugal
  - Transforma√ß√£o do setor energ√©tico
  - Dados de transmiss√£o
  - Integra√ß√£o de fontes renov√°veis

---

### 8. **Geoportal LNEG - Base de Dados Hidrogeol√≥gicos**
- **URL**: https://geoportal.lneg.pt/pt/bds/rec_hidrogeol
- **Dados Dispon√≠veis**:
  - Informa√ß√£o geol√≥gica
  - Recursos hidrogeol√≥gicos
  - Furos, po√ßos, nascentes
  - Sondagens em todo o pa√≠s

---

### 9. **APREN - Associa√ß√£o Portuguesa de Energias Renov√°veis**
- **Mapa E2P**: Mapa de Centros Eletroprodutores Renov√°veis em Portugal
- **Dados Dispon√≠veis**:
  - Localiza√ß√£o de todas as centrais renov√°veis
  - Classifica√ß√£o por tipo
  - Dados t√©cnicos

---

### 10. **INSPIRE Geoportal - Centrais H√≠dricas**
- **URL**: https://inspire-geoportal.ec.europa.eu/
- **Dados Dispon√≠veis**:
  - Grandes h√≠dricas e mini-h√≠dricas
  - Dados de licenciamento
  - Dados geoespaciais em conformidade europeia
  - Informa√ß√£o de Dire√ß√£o-Geral de Energia

---

### 11. **APA - Aproveitamentos Hidr√°ulicos e Concess√µes**
- **Lista de Instala√ß√µes (PDF)**: https://apambiente.pt/sites/default/files/_Agua/DRH/Licenciamento/AH_Concessoes/AH_Lista.pdf
- **Portal de Concess√µes**: https://apambiente.pt/agua/aproveitamentos-hidraulicos-concessoes
- **Dados Dispon√≠veis**:
  - Lista oficial de instala√ß√µes licenciadas
  - Informa√ß√£o sobre concess√µes de dom√≠nio h√≠drico

---

## 12. Dados Cr√≠ticos de Concess√£o e Opera√ß√£o

Para obter dados detalhados sobre **Dono/Operador, Prazos e Estado da Concess√£o**, utilize a seguinte estrat√©gia combinada:

### Fontes para Dados Contratuais
1. **SNITURH (APA) - T√≠tulos de Utiliza√ß√£o de Recursos H√≠dricos**
   - **O que procurar**: Identifica√ß√£o do titular oficial e prazo da licen√ßa.
   - **Como aceder**: Pesquisar listas de "T√≠tulos Emitidos" nos sites das ARH (Administra√ß√µes de Regi√£o Hidrogr√°fica) ou no portal da APA.

2. **Relat√≥rios Anuais de Operadores (EDP, Movhera, Iberdrola, Endesa)**
   - **EDP**: Consulte a sec√ß√£o "Ativos Intang√≠veis" nos Relat√≥rios e Contas Anuais. Detalha a vida √∫til restante das concess√µes.
   - **Movhera**: Det√©m as concess√µes do Douro (Miranda, Picote, Bemposta, Baixo Sabor, Feiticeiro, Foz Tua) adquiridas em 2020. Prazo m√©dio remanescente reportado na aquisi√ß√£o: ~45 anos.
   - **Iberdrola**: Sistema do T√¢mega (Gouv√£es, Daiv√µes, Alto T√¢mega). Concess√µes de 75 anos a contar do in√≠cio da explora√ß√£o (c. 2022-2024), v√°lidas at√© ~2097.

3. **Di√°rio da Rep√∫blica (DRE)**
   - A fonte definitiva para datas exatas.
   - **Pesquisa Chave**: `"contrato de concess√£o" + [Nome da Barragem]`
   - **Pesquisa Chave**: `"caducidade concess√£o aproveitamento"` (para identificar centrais revertidas ao Estado).

### Classifica√ß√£o de Estado da Concess√£o
- **Ativo**: Concess√£o em vigor (maioria das grandes barragens).
- **Prorroga√ß√£o**: Concess√£o expirou mas o operador mant√©m gest√£o provis√≥ria (ex: Barragem do Cabril, expirou em 2022).
- **Revertido/Expirado**: Concess√£o terminou e o ativo reverteu para o Estado (comum em mini-h√≠dricas antigas).

---

## üìã Estrutura Recomendada para Base de Dados (Completa)

Esta estrutura foi desenhada para capturar todas as dimens√µes do ativo: t√©cnica, geogr√°fica, legal e operacional.

### 1. Identifica√ß√£o e Estado (Tabela `centrais_hidricas`)
- `id_central` (PK - Chave Prim√°ria)
- `nome_oficial`: Nome registado no t√≠tulo (ex: "Aproveitamento Hidroel√©trico de France")
- `nome_comum`: Nome pelo qual √© conhecida (ex: "Barragem de Covas")
- `codigo_apa`: C√≥digo oficial da Ag√™ncia Portuguesa do Ambiente
- `codigo_snirh`: C√≥digo de monitoriza√ß√£o no SNIRH
- `estado_operacional`: Operacional / Em Constru√ß√£o / Desativada / Demolida
- `tipo_instalacao`: Barragem com Albufeira / Fio de √Ågua / Bombagem (PHE) / Mini-h√≠drica

### 2. Concess√£o e Propriedade (Tabela `concessoes`)
- `id_concessao` (PK)
- `central_id` (FK - Chave Estrangeira para `centrais_hidricas`)
- `operador_atual`: Entidade que explora (ex: Movhera, EDP Produ√ß√£o, Aquila Capital)
- `titular_titulo`: Titular legal do TURH (pode ser diferente do operador)
- `data_inicio_concessao`: Data de assinatura do contrato ou publica√ß√£o do decreto
- `data_fim_concessao`: Data de termo do contrato atual
- `duracao_anos`: Anos totais da concess√£o (ex: 75)
- `estado_legal`: Ativa / Prorrogada / Caducada / Revertida ao Estado
- `link_documento_legal`: URL para o contrato ou decreto no Di√°rio da Rep√∫blica
- `notas_contratuais`: Observa√ß√µes sobre condi√ß√µes especiais, prorroga√ß√µes, etc.

### 3. Localiza√ß√£o Geogr√°fica (Tabela `localizacoes`)
- `id_localizacao` (PK)
- `central_id` (FK)
- `bacia_hidrografica_principal`: (ex: Douro, Lima, Minho, Vouga)
- `curso_agua`: Rio ou ribeira espec√≠fica (ex: Rio Coura, Rio Tejo)
- `distrito`: Unidade administrativa (ex: Viana do Castelo, Vila Real)
- `concelho`: Munic√≠pio (ex: Vila Nova de Cerveira, Peso da R√©gua)
- `freguesia`: Divis√£o administrativa (ex: Covas, Sabrosa)
- `coordenadas_longitude`: Longitude (WGS84)
- `coordenadas_latitude`: Latitude (WGS84)
- `geom`: Objeto geom√©trico para GIS (Point SRID 4326)

### 4. Caracter√≠sticas T√©cnicas de Produ√ß√£o (Tabela `dados_tecnicos`)
- `id_dados_tecnicos` (PK)
- `central_id` (FK)
- `potencia_instalada_mw`: Pot√™ncia total instalada (ex: 44.1 MW)
- `produtibilidade_media_gwh`: Produ√ß√£o m√©dia anual (ex: 120.5 GWh)
- `ano_entrada_servico`: Ano de in√≠cio de opera√ß√£o comercial
- `num_grupos_geradores`: Quantidade de turbinas/grupos
- `tipo_turbinas`: Francis / Pelton / Kaplan / Bulbo / Crossflow
- `caudal_maximo_m3s`: Caudal m√°ximo turbin√°vel (m¬≥/s)
- `queda_bruta_m`: Desn√≠vel m√°ximo √∫til (metros)
- `eficiencia_media_percent`: Rendimento m√©dio de convers√£o

### 5. Barragem e Albufeira (Tabela `dados_hidraulicos`)
- `id_dados_hidraulicos` (PK)
- `central_id` (FK)
- `tipo_barragem`: Arco / Gravidade / Arco-Gravidade / Terra / Enrocamento / Desnivelada
- `altura_cota_fundacao_m`: Altura m√°xima desde a funda√ß√£o
- `comprimento_coroamento_m`: Extens√£o do topo da barragem
- `capacidade_total_hm3`: Volume total armazen√°vel (hm¬≥)
- `capacidade_util_hm3`: Volume utiliz√°vel para produ√ß√£o (hm¬≥)
- `area_inundada_km2`: √Årea da superf√≠cie da albufeira em NPA (km¬≤)
- `cota_npa_m`: N√≠vel de Pleno Armazenamento (metros)
- `cota_nme_m`: N√≠vel M√≠nimo de Explora√ß√£o (metros)
- `caudal_ecologico_m3s`: Caudal obrigat√≥rio para jusante

### 6. Dados de Monitoriza√ß√£o (Tabela `monitoriza√ß√£o_operacional`)
- `id_monitoramento` (PK)
- `central_id` (FK)
- `data_leitura`: Data/Hora da medi√ß√£o
- `volume_albufeira_hm3`: Volume atual armazenado
- `percentagem_enchimento`: N√≠vel de enchimento (%)
- `producao_diaria_gwh`: Produ√ß√£o do dia (GWh)
- `caudal_actual_m3s`: Caudal turbinado atual
- `fonte_dados`: SNIRH / EDP / Operador / Manual

---

## üîß Script SQL para Cria√ß√£o (PostgreSQL/PostGIS)

Este script cria uma estrutura relacional robusta, normalizada e pronta para produ√ß√£o.

```sql
-- ============================================================
-- EXTENS√ïES NECESS√ÅRIAS
-- ============================================================
CREATE EXTENSION IF NOT EXISTS postgis;
CREATE EXTENSION IF NOT EXISTS postgis_topology;

-- ============================================================
-- TABELA 1: CENTRAIS H√çDRICAS (Base)
-- ============================================================
CREATE TABLE centrais_hidricas (
    id_central SERIAL PRIMARY KEY,
    nome_oficial VARCHAR(255) NOT NULL UNIQUE,
    nome_comum VARCHAR(255),
    codigo_apa VARCHAR(50),
    codigo_snirh VARCHAR(50),
    tipo_instalacao VARCHAR(50) NOT NULL CHECK (
        tipo_instalacao IN ('Barragem Albufeira', 'Fio de √Ågua', 'Bombagem', 'Mini-h√≠drica')
    ),
    estado_operacional VARCHAR(50) DEFAULT 'Operacional' CHECK (
        estado_operacional IN ('Operacional', 'Em Constru√ß√£o', 'Desativada', 'Demolida', 'Pr√©-operacional')
    ),
    descricao TEXT,
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    data_atualizacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ============================================================
-- TABELA 2: CONCESS√ïES (Dados Legais e Contratuais)
-- ============================================================
CREATE TABLE concessoes (
    id_concessao SERIAL PRIMARY KEY,
    central_id INTEGER NOT NULL UNIQUE REFERENCES centrais_hidricas(id_central) ON DELETE CASCADE,
    operador_atual VARCHAR(150),
    titular_titulo VARCHAR(150) NOT NULL,
    data_inicio_concessao DATE,
    data_fim_concessao DATE,
    duracao_anos INTEGER,
    estado_legal VARCHAR(50) NOT NULL DEFAULT 'Ativa' CHECK (
        estado_legal IN ('Ativa', 'Prorroga√ß√£o', 'Caducada', 'Revertida', 'Em Renegocia√ß√£o')
    ),
    numero_decreto_lei VARCHAR(50), -- Ex: "Decreto-Lei n¬∫ 107/1970"
    link_documento_legal TEXT, -- URL para o Di√°rio da Rep√∫blica
    notas_contratuais TEXT,
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ============================================================
-- TABELA 3: LOCALIZA√á√ïES GEOGR√ÅFICAS
-- ============================================================
CREATE TABLE localizacoes (
    id_localizacao SERIAL PRIMARY KEY,
    central_id INTEGER NOT NULL UNIQUE REFERENCES centrais_hidricas(id_central) ON DELETE CASCADE,
    bacia_hidrografica VARCHAR(100) NOT NULL,
    curso_agua VARCHAR(100) NOT NULL,
    distrito VARCHAR(100) NOT NULL,
    concelho VARCHAR(100) NOT NULL,
    freguesia VARCHAR(100),
    coordenada_latitude NUMERIC(10, 6) NOT NULL,
    coordenada_longitude NUMERIC(10, 6) NOT NULL,
    geom GEOMETRY(POINT, 4326) NOT NULL, -- Formato GIS (WGS84)
    altitude_m INTEGER,
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ============================================================
-- TABELA 4: DADOS T√âCNICOS DE PRODU√á√ÉO
-- ============================================================
CREATE TABLE dados_tecnicos (
    id_dados_tecnicos SERIAL PRIMARY KEY,
    central_id INTEGER NOT NULL UNIQUE REFERENCES centrais_hidricas(id_central) ON DELETE CASCADE,
    potencia_instalada_mw NUMERIC(10, 2) NOT NULL,
    potencia_nominal_mw NUMERIC(10, 2),
    produtibilidade_media_gwh NUMERIC(10, 2),
    produtibilidade_minima_gwh NUMERIC(10, 2),
    produtibilidade_maxima_gwh NUMERIC(10, 2),
    ano_entrada_servico INTEGER,
    num_grupos_geradores INTEGER,
    tipo_turbinas VARCHAR(100),
    fabricante_turbinas VARCHAR(150),
    caudal_maximo_m3s NUMERIC(10, 2),
    caudal_minimo_m3s NUMERIC(10, 2),
    queda_bruta_m NUMERIC(10, 2),
    queda_liquida_m NUMERIC(10, 2),
    eficiencia_media_percent NUMERIC(5, 2),
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ============================================================
-- TABELA 5: DADOS HIDR√ÅULICOS E BARRAGEM
-- ============================================================
CREATE TABLE dados_hidraulicos (
    id_dados_hidraulicos SERIAL PRIMARY KEY,
    central_id INTEGER NOT NULL UNIQUE REFERENCES centrais_hidricas(id_central) ON DELETE CASCADE,
    tipo_barragem VARCHAR(100) NOT NULL,
    material_barragem VARCHAR(100),
    altura_cota_fundacao_m NUMERIC(10, 2),
    altura_coroamento_m NUMERIC(10, 2),
    comprimento_coroamento_m NUMERIC(10, 2),
    espessura_maxima_m NUMERIC(10, 2),
    capacidade_total_hm3 NUMERIC(10, 3),
    capacidade_util_hm3 NUMERIC(10, 3),
    capacidade_minima_hm3 NUMERIC(10, 3),
    area_inundada_km2 NUMERIC(10, 3),
    cota_npa_m NUMERIC(10, 2), -- N√≠vel de Pleno Armazenamento
    cota_nme_m NUMERIC(10, 2), -- N√≠vel M√≠nimo de Explora√ß√£o
    cota_fundacao_m NUMERIC(10, 2),
    caudal_ecologico_m3s NUMERIC(10, 2),
    caudal_vertedor_maximo_m3s NUMERIC(10, 2),
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ============================================================
-- TABELA 6: MONITORIZA√á√ÉO OPERACIONAL (Time Series)
-- ============================================================
CREATE TABLE monitorizacao_operacional (
    id_monitoramento SERIAL PRIMARY KEY,
    central_id INTEGER NOT NULL REFERENCES centrais_hidricas(id_central) ON DELETE CASCADE,
    data_leitura TIMESTAMP NOT NULL,
    volume_albufeira_hm3 NUMERIC(10, 3),
    percentagem_enchimento NUMERIC(5, 2) CHECK (percentagem_enchimento BETWEEN 0 AND 100),
    producao_diaria_gwh NUMERIC(10, 2),
    producao_horaria_mwh NUMERIC(10, 2),
    caudal_turbinado_m3s NUMERIC(10, 2),
    caudal_vertido_m3s NUMERIC(10, 2),
    caudal_ecologico_m3s NUMERIC(10, 2),
    temperatura_agua_celsius NUMERIC(5, 2),
    fonte_dados VARCHAR(100) CHECK (
        fonte_dados IN ('SNIRH', 'EDP', 'Operador', 'Manual', 'API_Externa')
    ),
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ============================================================
-- √çNDICES PARA PERFORMANCE
-- ============================================================
CREATE INDEX idx_centrais_nome ON centrais_hidricas(nome_oficial);
CREATE INDEX idx_centrais_tipo ON centrais_hidricas(tipo_instalacao);
CREATE INDEX idx_centrais_estado ON centrais_hidricas(estado_operacional);

CREATE INDEX idx_concessao_operador ON concessoes(operador_atual);
CREATE INDEX idx_concessao_fim ON concessoes(data_fim_concessao);
CREATE INDEX idx_concessao_estado ON concessoes(estado_legal);

CREATE INDEX idx_localizacao_bacia ON localizacoes(bacia_hidrografica);
CREATE INDEX idx_localizacao_concelho ON localizacoes(concelho);
CREATE INDEX idx_localizacao_geom ON localizacoes USING GIST(geom);

CREATE INDEX idx_monitoramento_data ON monitorizacao_operacional(data_leitura);
CREATE INDEX idx_monitoramento_central ON monitorizacao_operacional(central_id, data_leitura);
```

---

## üì• Exemplo de Inser√ß√£o de Dados (Mini-h√≠drica de France - Vila Nova de Cerveira)

```sql
-- ============================================================
-- 1. INSERIR CENTRAL HIDROEL√âTRICA
-- ============================================================
INSERT INTO centrais_hidricas (
    nome_oficial, 
    nome_comum, 
    codigo_apa, 
    tipo_instalacao, 
    estado_operacional
) VALUES (
    'Aproveitamento Hidroel√©trico de France',
    'Mini-h√≠drica de Covas / Central de France',
    'AH-CN-001',
    'Mini-h√≠drica',
    'Operacional'
) RETURNING id_central;

-- Resultado esperado: id_central = 1

-- ============================================================
-- 2. INSERIR LOCALIZA√á√ÉO
-- ============================================================
INSERT INTO localizacoes (
    central_id, 
    bacia_hidrografica, 
    curso_agua, 
    distrito, 
    concelho, 
    freguesia,
    coordenada_latitude, 
    coordenada_longitude,
    geom
) VALUES (
    1,
    'Minho',
    'Rio Coura',
    'Viana do Castelo',
    'Vila Nova de Cerveira',
    'Covas',
    41.889,
    -8.705,
    ST_SetSRID(ST_MakePoint(-8.705, 41.889), 4326)
);

-- ============================================================
-- 3. INSERIR DADOS DA CONCESS√ÉO
-- ============================================================
INSERT INTO concessoes (
    central_id,
    operador_atual,
    titular_titulo,
    data_inicio_concessao,
    data_fim_concessao,
    duracao_anos,
    estado_legal,
    numero_decreto_lei,
    link_documento_legal,
    notas_contratuais
) VALUES (
    1,
    'Aquila Capital',
    'Aquila Capital (ex-EDP Small Hydro)',
    '1970-03-11',
    '2045-03-11',
    75,
    'Ativa',
    'Decreto-Lei n¬∫ 107/1970',
    'https://diariodarepublica.pt/dr/detalhe/decreto-lei/107-1970-228669',
    'Transferida de EDP Small Hydro para Aquila Capital em Dezembro 2018. Portf√≥lio de 21 mini-h√≠dricas.'
);

-- ============================================================
-- 4. INSERIR DADOS T√âCNICOS
-- ============================================================
INSERT INTO dados_tecnicos (
    central_id,
    potencia_instalada_mw,
    potencia_nominal_mw,
    produtibilidade_media_gwh,
    ano_entrada_servico,
    num_grupos_geradores,
    tipo_turbinas,
    caudal_maximo_m3s,
    queda_bruta_m,
    eficiencia_media_percent
) VALUES (
    1,
    1.2,
    1.2,
    5.0,
    1974,
    1,
    'Francis',
    0.6,
    25.0,
    82.0
);

-- ============================================================
-- 5. INSERIR DADOS DA BARRAGEM
-- ============================================================
INSERT INTO dados_hidraulicos (
    central_id,
    tipo_barragem,
    material_barragem,
    altura_coroamento_m,
    capacidade_total_hm3,
    cota_npa_m,
    cota_nme_m,
    caudal_ecologico_m3s
) VALUES (
    1,
    'Pequena Barragem',
    'Bet√£o',
    8.0,
    0.50,
    150.0,
    145.0,
    0.15
);
```

---

## üìä Consultas √öteis para An√°lise

```sql
-- Listar todas as centrais com concess√£o a expirar nos pr√≥ximos 10 anos
SELECT 
    ch.nome_oficial,
    c.operador_atual,
    c.data_fim_concessao,
    (c.data_fim_concessao - CURRENT_DATE) / 365 AS anos_restantes,
    l.bacia_hidrografica
FROM centrais_hidricas ch
JOIN concessoes c ON ch.id_central = c.central_id
JOIN localizacoes l ON ch.id_central = l.central_id
WHERE c.data_fim_concessao BETWEEN CURRENT_DATE AND CURRENT_DATE + INTERVAL '10 years'
ORDER BY c.data_fim_concessao ASC;

-- Capacidade total de armazenamento por bacia hidrogr√°fica
SELECT 
    l.bacia_hidrografica,
    COUNT(ch.id_central) AS num_centrais,
    SUM(dh.capacidade_total_hm3) AS capacidade_total_hm3,
    SUM(dt.potencia_instalada_mw) AS potencia_total_mw
FROM centrais_hidricas ch
JOIN localizacoes l ON ch.id_central = l.central_id
JOIN dados_hidraulicos dh ON ch.id_central = dh.central_id
JOIN dados_tecnicos dt ON ch.id_central = dt.central_id
WHERE ch.tipo_instalacao = 'Barragem Albufeira'
GROUP BY l.bacia_hidrografica
ORDER BY capacidade_total_hm3 DESC;

-- Localizar centrais por operador
SELECT 
    c.operador_atual,
    COUNT(ch.id_central) AS num_centrais,
    SUM(dt.potencia_instalada_mw) AS potencia_mw,
    SUM(dt.produtibilidade_media_gwh) AS producao_gwh_ano
FROM centrais_hidricas ch
JOIN concessoes c ON ch.id_central = c.central_id
JOIN dados_tecnicos dt ON ch.id_central = dt.central_id
WHERE c.operador_atual IS NOT NULL
GROUP BY c.operador_atual
ORDER BY potencia_mw DESC;

-- Centrais ordenadas por pot√™ncia instalada (Top 10)
SELECT 
    ch.nome_oficial,
    l.bacia_hidrografica,
    c.operador_atual,
    dt.potencia_instalada_mw,
    dt.produtibilidade_media_gwh,
    ch.tipo_instalacao
FROM centrais_hidricas ch
JOIN dados_tecnicos dt ON ch.id_central = dt.central_id
JOIN localizacoes l ON ch.id_central = l.central_id
JOIN concessoes c ON ch.id_central = c.central_id
ORDER BY dt.potencia_instalada_mw DESC
LIMIT 10;
```

---

## ‚úÖ Checklist de Implementa√ß√£o

- [ ] Criar base de dados PostgreSQL com PostGIS
- [ ] Executar script SQL de cria√ß√£o (tabelas, √≠ndices, constraints)
- [ ] Definir pol√≠ticas de backup e replica√ß√£o
- [ ] Implementar API REST para consultas (ex: usando PostgREST)
- [ ] Criar dashboards de visualiza√ß√£o (ex: Grafana, Tableau)
- [ ] Automatizar importa√ß√£o de dados do SNIRH (API/Web scraping)
- [ ] Validar integridade de dados (duplicatas, missing values)
- [ ] Documentar dicion√°rio de dados (data dictionary)
- [ ] Treinar utilizadores finais
- [ ] Estabelecer calend√°rio de atualiza√ß√£o mensal/semanal

---

## üìù Notas Importantes

1. **Modelo Relacional**: As 6 tabelas evitam redund√¢ncia e permitem atualiza√ß√µes independentes
2. **PostGIS**: Permite an√°lises geoespaciais avan√ßadas (buffer, nearest neighbor, etc.)
3. **√çndices**: Essenciais para performance com grandes volumes de dados
4. **Time Series**: A tabela `monitorizacao_operacional` pode armazenar hist√≥rico cont√≠nuo
5. **Auditoria**: Campos `data_criacao` e `data_atualizacao` rastreiam mudan√ßas